#include <protomol/addon/Electrode.h>

using namespace ProtoMolAddon;

Electrode::Electrode() :
  pot(NULL), volt(NULL) {}


Electrode::~Electrode() {
  delete pot;
  delete volt;
}

void Electrode::GetElectricField(double t, const Vector3D& pos, Vector3D& field) {
  pot->GetGradient(pos, field);
  double v = volt->GetVoltage(t);
  
  for (int i=0; i<3; i++)
    field[i] *= v;
}
